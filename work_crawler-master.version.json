{"user_name":"kanasimi","repository":"work_crawler","branch":"master","check_date":"2024-06-20T04:04:35.175Z","latest_version_file":"work_crawler-master.version.json","latest_commit":{"sha":"d820090ffc2c05a1e1625e74630e735f1bfd4218","node_id":"C_kwDOBFQwbdoAKGQ4MjAwOTBmZmMyYzA1YTFlMTYyNWU3NDYzMGU3MzVmMWJmZDQyMTg","commit":{"author":{"name":"kanasimi","email":"kanasimi@gmail.com","date":"2024-06-16T00:06:57Z"},"committer":{"name":"kanasimi","email":"kanasimi@gmail.com","date":"2024-06-16T00:06:57Z"},"message":"misc","tree":{"sha":"758a8633e8200517452d34b39380f8f803856bd4","url":"https://api.github.com/repos/kanasimi/work_crawler/git/trees/758a8633e8200517452d34b39380f8f803856bd4"},"url":"https://api.github.com/repos/kanasimi/work_crawler/git/commits/d820090ffc2c05a1e1625e74630e735f1bfd4218","comment_count":0,"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExI9CWXCBKhvKWe3QQ9cbae2KbdIFAmZuLKoACgkQQ9cbae2K\nbdJzMQ//Vn1yKsUWn4rR7o2R2JmNZ07yPaTsxoCU2Dy8rSJ6EeqEB4n5OuYhJtFp\nwdieqUBvi4rr2JziHs7L43aUHG+bbCVetu4AMzg8tEy4xPFG6BUf5KISvJeca+ur\n4Wz3UTns2IKQgFOGX7UiGeqcqKceZz7flB/jsVzA7tIhCUpgT+DbOpsDxukEY3n6\nQcusnLScaDoeaIE0k2pYtCUOsJpjwqVHYkevZjPQBN5vVD4W5yoZFocyAuFPA3mT\n2BrD2JBJ2x/K2dJY2/lnL+BZV3Yl5Qhx0NSsetNQla4kIRee7mz/bpE4SKHj9tOT\nDqZo/hMYEcP/Ofxlh046xMn5/KIW7ESi0Ccfyxy1wcTlPzxvVFeptqGaxbq0ShbJ\ncI8eiG5XTlkWT4Lom6ek8tDAQNFoty/2ywm2CwGBFvRDJdZ3qV9uxtl0iR/zp4KH\nirWUClpgjnWxOjT+ih8YFwHxSYjSh7z9mGZmusl0zQhHQqkxX/gkLEllFAjGh/RC\ni8mHWNa1fcyomB4BrCaK95CtkRamVmIc27FXnLD3NuL0vLwDRonYMlbkfzVJx0eR\nyG3pTJ2YgFwb+bt/KH9f1wFd5/GXooqZqPoSe6dtt2YcxDGvrYaKVOV2AEWTpDQe\nJF7idvZiv5nXwLuPjggpSfraaC6U4bScUSmK6X3ElUjbMPPtdEY=\n=QIUE\n-----END PGP SIGNATURE-----","payload":"tree 758a8633e8200517452d34b39380f8f803856bd4\nparent e1cf01b2d4df1a31a6a4ee98153d3f9a204a6ccf\nauthor kanasimi <kanasimi@gmail.com> 1718496417 +0800\ncommitter kanasimi <kanasimi@gmail.com> 1718496417 +0800\n\nmisc\n"}},"url":"https://api.github.com/repos/kanasimi/work_crawler/commits/d820090ffc2c05a1e1625e74630e735f1bfd4218","html_url":"https://github.com/kanasimi/work_crawler/commit/d820090ffc2c05a1e1625e74630e735f1bfd4218","comments_url":"https://api.github.com/repos/kanasimi/work_crawler/commits/d820090ffc2c05a1e1625e74630e735f1bfd4218/comments","author":{"login":"kanasimi","id":186866,"node_id":"MDQ6VXNlcjE4Njg2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/186866?v=4","gravatar_id":"","url":"https://api.github.com/users/kanasimi","html_url":"https://github.com/kanasimi","followers_url":"https://api.github.com/users/kanasimi/followers","following_url":"https://api.github.com/users/kanasimi/following{/other_user}","gists_url":"https://api.github.com/users/kanasimi/gists{/gist_id}","starred_url":"https://api.github.com/users/kanasimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kanasimi/subscriptions","organizations_url":"https://api.github.com/users/kanasimi/orgs","repos_url":"https://api.github.com/users/kanasimi/repos","events_url":"https://api.github.com/users/kanasimi/events{/privacy}","received_events_url":"https://api.github.com/users/kanasimi/received_events","type":"User","site_admin":false},"committer":{"login":"kanasimi","id":186866,"node_id":"MDQ6VXNlcjE4Njg2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/186866?v=4","gravatar_id":"","url":"https://api.github.com/users/kanasimi","html_url":"https://github.com/kanasimi","followers_url":"https://api.github.com/users/kanasimi/followers","following_url":"https://api.github.com/users/kanasimi/following{/other_user}","gists_url":"https://api.github.com/users/kanasimi/gists{/gist_id}","starred_url":"https://api.github.com/users/kanasimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kanasimi/subscriptions","organizations_url":"https://api.github.com/users/kanasimi/orgs","repos_url":"https://api.github.com/users/kanasimi/repos","events_url":"https://api.github.com/users/kanasimi/events{/privacy}","received_events_url":"https://api.github.com/users/kanasimi/received_events","type":"User","site_admin":false},"parents":[{"sha":"e1cf01b2d4df1a31a6a4ee98153d3f9a204a6ccf","url":"https://api.github.com/repos/kanasimi/work_crawler/commits/e1cf01b2d4df1a31a6a4ee98153d3f9a204a6ccf","html_url":"https://github.com/kanasimi/work_crawler/commit/e1cf01b2d4df1a31a6a4ee98153d3f9a204a6ccf"}],"stats":{"total":33,"additions":17,"deletions":16},"files":[{"sha":"fc189ad2188900f3e6fe8a6d1fddb960c15c627c","filename":"book.cmn-Hant-TW/epub_hans_to_hant.js","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/kanasimi/work_crawler/blob/d820090ffc2c05a1e1625e74630e735f1bfd4218/book.cmn-Hant-TW%2Fepub_hans_to_hant.js","raw_url":"https://github.com/kanasimi/work_crawler/raw/d820090ffc2c05a1e1625e74630e735f1bfd4218/book.cmn-Hant-TW%2Fepub_hans_to_hant.js","contents_url":"https://api.github.com/repos/kanasimi/work_crawler/contents/book.cmn-Hant-TW%2Fepub_hans_to_hant.js?ref=d820090ffc2c05a1e1625e74630e735f1bfd4218","patch":"@@ -56,7 +56,7 @@ function guess_work_title(epub_directory) {\n \t\tCeL.info('guess_work_title: 《' + work_title + '》');\n \t}\n \n-\t// console.trace([work_title,matched]);\n+\t// console.trace([ work_title, matched ]);\n \treturn work_title;\n }\n \n@@ -94,6 +94,7 @@ function handle_files() {\n \tarchive_file.ebook_file_list = [];\n \n \twork_title = guess_work_title(epub_directory);\n+\t// console.trace(work_title);\n \n \t// --------------------------------\n "},{"sha":"fb74e1364c2bc12e5fe101bb76ae53152623708f","filename":"book.cmn-Hant-TW/ljswio.js","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/kanasimi/work_crawler/blob/d820090ffc2c05a1e1625e74630e735f1bfd4218/book.cmn-Hant-TW%2Fljswio.js","raw_url":"https://github.com/kanasimi/work_crawler/raw/d820090ffc2c05a1e1625e74630e735f1bfd4218/book.cmn-Hant-TW%2Fljswio.js","contents_url":"https://api.github.com/repos/kanasimi/work_crawler/contents/book.cmn-Hant-TW%2Fljswio.js?ref=d820090ffc2c05a1e1625e74630e735f1bfd4218","patch":"@@ -116,7 +116,7 @@ var crawler = new CeL.work_crawler({\n \t\t\t\terror_retry : _this.MAX_ERROR_RETRY\n \t\t\t}, this.get_URL_options, {\n \t\t\t\t// 有些檔案比較大，必須花費比較多時間。\n-\t\t\t\ttimeout : 60 * 1000\n+\t\t\t\ttimeout : 1 * 60 * 1000\n \t\t\t})\n \t\t});\n \t},\n@@ -128,7 +128,7 @@ var crawler = new CeL.work_crawler({\n \t\tcount = 0, matched, PATTERN_media = /<audio [^<>]*?src=\"([^<>\"]+)\"/g;\n \t\twhile (matched = PATTERN_media.exec(html)) {\n \t\t\tCeL.create_directory(directory);\n-\t\t\tvar url = matched[1], extension = url.match(/\\.[^.]+$/)[0];\n+\t\t\tvar url = matched[1], extension = url.match(/(\\.[^.?]+)(?:\\?.*)?$/)[1];\n \t\t\tthis.media_list.push({\n \t\t\t\tfile : directory\n \t\t\t\t\t\t+ chapter_NO.pad(work_data.chapter_NO_pad_digits || 4)"},{"sha":"58d60352c5b533b71e574b7d795dee727abfa532","filename":"book.cmn-Hant-TW/podcasts.js","status":"modified","additions":1,"deletions":3,"changes":4,"blob_url":"https://github.com/kanasimi/work_crawler/blob/d820090ffc2c05a1e1625e74630e735f1bfd4218/book.cmn-Hant-TW%2Fpodcasts.js","raw_url":"https://github.com/kanasimi/work_crawler/raw/d820090ffc2c05a1e1625e74630e735f1bfd4218/book.cmn-Hant-TW%2Fpodcasts.js","contents_url":"https://api.github.com/repos/kanasimi/work_crawler/contents/book.cmn-Hant-TW%2Fpodcasts.js?ref=d820090ffc2c05a1e1625e74630e735f1bfd4218","patch":"@@ -181,9 +181,7 @@ var crawler = new CeL.work_crawler({\n \t\t//\n \t\textension = url.match(/(\\.[^.?]+)(?:\\?.*)?$/)[1];\n \n-\t\tvar old_file_name = directory\n-\t\t//\n-\t\t+ CeL.to_file_name(title) + extension;\n+\t\tvar old_file_name = directory + CeL.to_file_name(title) + extension;\n \n \t\tvar file_name = directory\n \t\t//"},{"sha":"f1b2619e1c6f56f26e27f04e64dbdeda5ec016c7","filename":"document/README.cmn-Hant-TW.md","status":"modified","additions":9,"deletions":9,"changes":18,"blob_url":"https://github.com/kanasimi/work_crawler/blob/d820090ffc2c05a1e1625e74630e735f1bfd4218/document%2FREADME.cmn-Hant-TW.md","raw_url":"https://github.com/kanasimi/work_crawler/raw/d820090ffc2c05a1e1625e74630e735f1bfd4218/document%2FREADME.cmn-Hant-TW.md","contents_url":"https://api.github.com/repos/kanasimi/work_crawler/contents/document%2FREADME.cmn-Hant-TW.md?ref=d820090ffc2c05a1e1625e74630e735f1bfd4218","patch":"@@ -223,14 +223,14 @@\n 2. 下載並儲存本工具安裝檔 <code>[work_crawler.updater.js](https://raw.githubusercontent.com/kanasimi/work_crawler/master/work_crawler.updater.js)</code>（按右鍵另存新檔）。本工具安裝檔 **預設會將所有組件放在 `work_crawler-master` 目錄下**。\n 3. 若在中國大陸使用本工具，您可能需要更改預設 npm registry 至[淘宝 npm 镜像](https://developer.aliyun.com/mirror/NPM)，以加快下載速度：<details><summary>（點擊本處可獲得更詳細的說明）</summary>\n    * 請在命令列介面下執行下列指令，將會修改 [.npmrc](https://docs.npmjs.com/misc/config) 設定檔：可參考 [npm 淘宝镜像配置](https://gist.github.com/52cik/c1de8926e20971f415dd)\n-      ```bash\n+      ```sh\n       npm config set registry https://registry.npm.taobao.org\n \t  npm config set disturl https://npm.taobao.org/dist\n       npm config set electron_mirror https://npm.taobao.org/mirrors/electron/\n       ```\n \n       附注：恢復預設設定請執行\n-      ```bash\n+      ```sh\n       npm config delete registry\n \t  npm config delete disturl\n       npm config delete electron_mirror\n@@ -250,7 +250,7 @@\n       * 若是您視窗的 **背景為黑色**，表示您使用的可能是 [Command Prompt 命令提示字元](https://zh.wikipedia.org/wiki/%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E5%AD%97%E5%85%83)，您應該使用這種形式的指令來切換目錄：`cd/d \"本工具安裝檔所在的目錄\"`（**cd/d** 表示「同時變更工作磁碟機及其工作目錄」的意思）。\n \n    3. **執行命令以下載最新版本組件**（本安裝檔必須以 `node` 執行， **不能直接點擊兩下執行**。）：\n-      ```bash\n+      ```sh\n       node work_crawler.updater.js\n       ```\n \n@@ -263,7 +263,7 @@\n    ![下載 CeJS 程式庫後本工具安裝的目錄看起來的樣子](https://lh3.googleusercontent.com/rVTuL3GHoWjXcJBW3O0KutvRTlf-HjQa5dzm_PJwizhMDN38JG8RIdJ7nuZyWA6m2G9d2McEP_XdyNmGwn0kVdSjwDzJaS6w9D9SOtETBCnO9fAue82-J3qMtEm8yxgkjOLr5EBnjg=w150-h330-no)\n \n    以下是在linux下直接操作上述作業時的指令，Windows用戶可以跳過，直接[開始試用](#execution-執行)。\n-   ```bash\n+   ```sh\n    # sample commands to extract work_crawler + cejs\n    curl -O https://raw.githubusercontent.com/kanasimi/work_crawler/master/work_crawler.updater.js\n    # wget https://raw.githubusercontent.com/kanasimi/work_crawler/master/work_crawler.updater.js\n@@ -281,14 +281,14 @@\n       **請記得在引號中，目錄分隔號必須輸入兩次！** 這不會影響到您之前曾手動改變過的標的目錄。\n \n 8. 每次要更新到最新版本時，只要進到工具安裝檔所在目錄，重新執行一次本工具安裝檔即可。\n-   ```bash\n+   ```sh\n    node work_crawler.updater.js\n    ```\n    由於本工具會 cache 作品資訊，更新幅度較大的時候，新程式可能無法讀取這些舊格式的 cache，會產生錯誤；此時您需要刪除下載目錄中所有的 cache，重新下載作品。這些 cache 包括 search.json, servers.json 以及作品目錄下面，以作品名稱為名的 .json 檔案。\n \n <!-- use npm:\n 3. 在命令列介面下，進到解壓縮後工具檔所在的目錄，執行命令以下載 CeJS 程式庫：（`npm install` 可能將 cejs 安裝在此目錄下之 node_modules/cejs 目錄內 ）\n-   ```bash\n+   ```sh\n    npm install cejs\n    ```\n 4. 然後就能[開始試用](#execution-執行)囉。\n@@ -303,7 +303,7 @@\n #### Setup GUI 設定視窗型態介面\n 若是您在作研究開發時，希望使用[圖形使用者介面](https://zh.wikipedia.org/wiki/%E5%9B%BE%E5%BD%A2%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2)，那麼您還需要安裝 [Electron](https://electronjs.org/)。若是您採用懶人安裝法，應該已經安裝過 Electron，可以直接採用圖形使用者介面。\n 1. 請在[命令列介面](https://zh.wikipedia.org/wiki/%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%95%8C%E9%9D%A2)下，進到本工具安裝的目錄，執行命令以安裝 Electron 程式庫：\n-   ```bash\n+   ```sh\n    npm i -D electron@latest\n    ```\n 2. 在本工具安裝的目錄下，執行 `start_gui_electron.bat` 或 `start_gui_electron.sh`。\n@@ -329,13 +329,13 @@\n 所有操作都必須進到工具檔所在的目錄，在命令列介面下執行。\n 1. 確認要下載的網站名與作品名。之後在命令列介面下，執行：（請在作品的名稱外面加上引號）\n \n-   ```bash\n+   ```sh\n    node 工具檔名.js \"作品名\" [option=true] [option=value]\n    node 工具檔名.js \"l=作品列表檔案名\" [option=true] [option=value]\n    ```\n \n    e.g.,\n-   ```bash\n+   ```sh\n    cd comic.cmn-Hans-CN && node qq.js \"狐妖小红娘\" skip_error=true\n    cd novel.cmn-Hans-CN && node qidian free && echo \"下载 起点中文网限免作品\"\n    cd novel.cmn-Hans-CN && node 23us \"斗罗大陆Ⅲ龙王传说\" proxy=localhost:8080"},{"sha":"fe6350eea9c7e5531361e283df941a14585f51e9","filename":"novel.cmn-Hans-CN/fxnzw.js","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/kanasimi/work_crawler/blob/d820090ffc2c05a1e1625e74630e735f1bfd4218/novel.cmn-Hans-CN%2Ffxnzw.js","raw_url":"https://github.com/kanasimi/work_crawler/raw/d820090ffc2c05a1e1625e74630e735f1bfd4218/novel.cmn-Hans-CN%2Ffxnzw.js","contents_url":"https://api.github.com/repos/kanasimi/work_crawler/contents/novel.cmn-Hans-CN%2Ffxnzw.js?ref=d820090ffc2c05a1e1625e74630e735f1bfd4218","patch":"@@ -130,7 +130,9 @@ var crawler = new CeL.work_crawler({\n \t\thtml.each_between('<div id=\"NclassTitle\">', null, function(text) {\n \t\t\tvar part_title = text.between(null, '</div>');\n \t\t\t// console.trace(part_title);\n-\t\t\t// if (part_title && !part_title.includes('正文'))\n+\t\t\tif (part_title.includes('正文')) {\n+\t\t\t\tpart_title = '';\n+\t\t\t}\n \t\t\tcrawler.set_part(work_data, part_title);\n \n \t\t\ttext = text.between('<ul>', '</ul>');"}]},"latest_version":"2024-06-16T00:06:57Z","has_new_version":true}